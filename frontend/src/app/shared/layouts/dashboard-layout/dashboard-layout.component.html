<div class="dashboard-layout" [attr.data-theme]="themeService.currentTheme()">
  <!-- Overlay para móvil -->
  @if (sidebarService.isSidebarOpen()) {
    <div
      class="dashboard-overlay"
      (click)="toggleSidebar()">
    </div>
  }

  <!-- Sidebar Component CECYTEC -->
  <app-sidebar
    [sidebarService]="sidebarService"
    [themeService]="themeService"
    (closeSidebar)="toggleSidebar()"
    (navigate)="onNavigate($event)"
    (logout)="logout()">
  </app-sidebar>


  <!-- Botón toggle en la línea divisoria vertical -->
  <button
    class="fixed z-[10000] hidden lg:flex btn btn-circle btn-sm toggle-btn shadow-lg transition-all duration-300"
    [class.left-[304px]]="!sidebarService.isSidebarCollapsed()"
    [class.left-[68px]]="sidebarService.isSidebarCollapsed()"
    [style.top.px]="21"
    (click)="toggleSidebarCollapse()"
    [title]="sidebarService.isSidebarCollapsed() ? 'Expandir sidebar' : 'Contraer sidebar'">
    <lucide-icon
      [img]="sidebarService.isSidebarCollapsed() ? panelLeftIcon : panelLeftCloseIcon"
      class="w-4 h-4"
    ></lucide-icon>
  </button>

  <!-- Contenido principal -->
  <div
    class="transition-all duration-300"
    [class.lg:ml-80]="!sidebarService.isSidebarCollapsed()"
    [class.lg:ml-20]="sidebarService.isSidebarCollapsed()"
    style="border: none !important; box-shadow: none !important;">
    <!-- Topbar Component CECYTEC -->
    <app-topbar
      [themeService]="themeService"
      [title]="'Dashboard'"
      [subtitle]="'Bienvenido de vuelta, ' + currentUser.name"
      [currentUser]="currentUser"
      [notificationCount]="notificationCount"
      (toggleSidebar)="toggleSidebar()"
      (toggleTheme)="toggleDarkMode()"
      (showNotifications)="showNotifications()"
      (showProfile)="showProfile()">
    </app-topbar>

    <!-- Contenido de la pagina -->
    <main 
      class="p-6 pt-2"
      [style.background-color]="themeService.currentTheme() === 'dracula' || themeService.currentTheme() === 'dark' ? '#374151' : ''"
      [style.background]="themeService.currentTheme() === 'dracula' || themeService.currentTheme() === 'dark' ? '#374151 !important' : ''"
      [style.background-image]="themeService.currentTheme() === 'dracula' || themeService.currentTheme() === 'dark' ? 'none' : ''">
      <router-outlet></router-outlet>
    </main>
    
    <!-- Footer flotante -->
    <footer class="footer-floating">
      <div class="footer-content">
        <div class="footer-left">
          <p class="footer-text">© 2025 - Todos los derechos reservados</p>
        </div>
        <div class="footer-right">
          <p class="footer-version">SICAAD v4.0</p>
        </div>
      </div>
    </footer>
  </div>
</div>
